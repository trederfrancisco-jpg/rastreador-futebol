
<script>
  let data = {};

  async function loadData() {
    try {
      const response = await fetch('/data.json');
      if (!response.ok) throw new Error('Falha ao carregar data.json');
      data = await response.json();
      filterAndDisplay('all');
    } catch (error) {
      console.error('Erro:', error);
      document.getElementById("results").innerHTML = `<p>‚ùå Falha ao carregar dados.</p>`;
    }
  }

  function filterAndDisplay(type) {
    const leagueFilter = document.getElementById("leagueSelect").value;
    const today = new Date('2025-10-15');
    const nextWeek = new Date(today);
    nextWeek.setDate(today.getDate() + 2);

    let matches = [];

    const leagues = {
      brasileirao: data.brasileirao || [],
      premierLeague: data.premierLeague || [],
      laliga: data.laliga || [],
      serieA: data.serieA || [],
      bundesliga: data.bundesliga || [],
      ligue1: data.ligue1 || [],
      libertadores: data.libertadores || [],
      champions: data.champions || [],
      europa: data.europa || []
    };

    let selectedLeagues = [];
    if (leagueFilter && leagues[leagueFilter]) {
      selectedLeagues = leagues[leagueFilter];
    } else {
      selectedLeagues = [
        ...leagues.brasileirao,
        ...leagues.premierLeague,
        ...leagues.laliga,
        ...leagues.serieA,
        ...leagues.bundesliga,
        ...leagues.ligue1,
        ...leagues.libertadores,
        ...leagues.champions,
        ...leagues.europa
      ];
    }

    selectedLeagues.forEach(day => {
      if (!day || !day.date || !Array.isArray(day.matches)) return;
      const gameDate = new Date(day.date);
      if (gameDate >= today && gameDate <= nextWeek) {
        day.matches.forEach(match => {
          if (!match || !match.home || !match.away) return;

          const homeIsG4 = isG4Team(match.home);
          const awayIsG4 = isG4Team(match.away);

          // Regra 1: Ignorar jogos G4 vs G4
          if (homeIsG4 && awayIsG4) {
            // Pode adicionar aqui um log ou ignorar silenciosamente
            return;
          }

          // Regra 2: S√≥ considerar se pelo menos um time for G4 e o outro n√£o
          const isG4VsNonG4 = (homeIsG4 && !awayIsG4) || (!homeIsG4 && awayIsG4);

          if (isG4VsNonG4) {
            // Regra 3: Verificar se o time do G4 perdeu ou empatou o √∫ltimo jogo
            const g4Team = homeIsG4 ? match.home : match.away;
            const lastResult = getLastResult(g4Team); // Fun√ß√£o simulada

            if (lastResult === 'derrota' || lastResult === 'empate') {
              matches.push({
                home: match.home,
                away: match.away,
                date: day.date,
                time: match.time,
                stadium: match.stadium || 'Est√°dio n√£o informado',
                city: match.city || '',
                league: getLeagueName(match),
                strategy: `Time do G4 (${g4Team}) vem de ${lastResult} e joga contra time fora do G4 ‚Üí Alta probabilidade de rea√ß√£o`,
                risk: "Baixo",
                badge: "Rea√ß√£o do G4"
              });
            }
          }
        });
      }
    });

    matches.sort((a, b) => new Date(a.date) - new Date(b.date));
    renderMatches(matches);
  }

  function renderMatches(games) {
    const container = document.getElementById("results");
    const date = new Date().toLocaleDateString('pt-BR');

    let html = `<div class="section-title">üî• PR√ìXIMOS EM ALTA (${formatDateRange(new Date('2025-10-15'))})</div>`;

    if (games.length === 0) {
      html += `<p>Nenhum jogo encontrado com a l√≥gica de "Rea√ß√£o do G4".<br>‚úÖ Jogos G4 vs G4 foram ignorados conforme sua l√≥gica.</p>`;
    } else {
      games.forEach(game => {
        const riskClass = 'green';
        const location = game.stadium ? `üèüÔ∏è ${game.stadium}` + (game.city ? ` (${game.city})` : '') : 'üèüÔ∏è Local n√£o informado';
        html += `
          <div class="item">
            <h3>${game.home} vs. ${game.away}</h3>
            <div class="details">
              ‚è∞ ${formatDate(game.date)} √†s ${game.time} | ${location} | üèÜ ${game.league}<br>
              <strong>Estrat√©gia:</strong> ${game.strategy}
            </div>
            <div style="display: flex; gap: 10px; margin-top: 8px;">
              <span class="badge green">${game.badge}</span>
              <span class="risk ${riskClass}">${game.risk} Risco</span>
            </div>
          </div>
        `;
      });
    }

    html += `<div class="tip">üìÖ Dados atualizados em: ${date}</div>`;
    container.innerHTML = html;
  }

  function formatDate(dateStr) {
    return new Date(dateStr).toLocaleDateString('pt-BR');
  }

  function formatDateRange(start) {
    const end = new Date(start);
    end.setDate(start.getDate() + 2);
    return `${formatDate(start)} a ${formatDate(end)}`;
  }

  function getLeagueName(match) {
    const home = match.home;
    if (home.includes("Arsenal") || home.includes("Liverpool") || home.includes("Manchester")) return "Premier League";
    if (home.includes("Barcelona") || home.includes("Real Madrid") || home.includes("Atl√©tico Madrid")) return "LaLiga";
    if (home.includes("Juventus") || home.includes("Milan") || home.includes("Inter") || home.includes("Napoli")) return "Serie A";
    if (home.includes("Bayern") || home.includes("Dortmund") || home.includes("Leipzig")) return "Bundesliga";
    if (home.includes("PSG") || home.includes("Marseille") || home.includes("Lyon")) return "Ligue 1";
    if (home.includes("Flamengo") || home.includes("Palmeiras") || home.includes("Botafogo") || home.includes("Gr√™mio") || home.includes("Atl√©tico-MG")) return "Brasileir√£o";
    return "Outro";
  }

  function isG4Team(team) {
    const g4Teams = [
      "Flamengo", "Palmeiras", "Botafogo", "Gr√™mio", "Atl√©tico-MG", "Internacional",
      "Arsenal", "Liverpool", "Manchester City", "Chelsea",
      "Barcelona", "Real Madrid", "Atl√©tico Madrid", "Villarreal",
      "Juventus", "AC Milan", "Inter", "Napoli",
      "Bayern", "Dortmund", "Leipzig", "Bayer Leverkusen",
      "PSG", "Marseille", "Lyon", "Monaco"
    ];
    return g4Teams.some(g4 => team.includes(g4));
  }

  // ‚öôÔ∏è SIMULA√á√ÉO: Retorna o √∫ltimo resultado do time (em produ√ß√£o, viria de API)
  function getLastResult(team) {
    // Simulando: Palmeiras e Gr√™mio vieram de derrota, Botafogo de empate
    const results = {
      "Palmeiras": "derrota",
      "Gr√™mio": "derrota",
      "Botafogo": "empate",
      "Atl√©tico-MG": "vit√≥ria", // N√£o ativa a l√≥gica
      "Fluminense": "vit√≥ria"  // N√£o √© G4
    };
    return results[team] || "vit√≥ria"; // Se n√£o estiver na lista, assume vit√≥ria (n√£o ativa l√≥gica)
  }

  function setActiveButton(clickedBtn) {
    document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
    clickedBtn.classList.add("active");
  }

  document.getElementById("btnChance").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('chance');
  });
  document.getElementById("btnPressureAlert").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('pressure');
  });
  document.getElementById("btnHiddenConflicts").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('hidden');
  });
  document.getElementById("btnReactionChain").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('chain');
  });
  document.getElementById("btnMultiples").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('multiples');
  });

  document.getElementById("leagueSelect").addEventListener("change", () => filterAndDisplay('all'));

  const translations = {
    pt: { title: "Rastreador Avan√ßado - M√∫ltiplos em Alta", btnPrimary: "üöÄ QUERO ASSINAR O RASTREADOR PRO" },
    en: { title: "Advanced Tracker - High Probability Multiples", btnPrimary: "üöÄ I WANT TO JOIN THE PRO TRACKER" },
    es: { title: "Rastreador Avanzado - M√∫ltiples en Alta", btnPrimary: "üöÄ QUIERO SUSCRIBIRME AL RASTREADOR PRO" }
  };

  function translatePage(lang) {
    document.title = translations[lang]?.title || translations.pt.title;
    const btn = document.querySelector(".btn-primary");
    if (btn) btn.textContent = translations[lang]?.btnPrimary || translations.pt.btnPrimary;
  }

  document.getElementById("languageSelector").addEventListener("change", function() {
    const lang = this.value;
    translatePage(lang);
    localStorage.setItem('language', lang);
  });

  document.addEventListener('DOMContentLoaded', function() {
    const savedLang = localStorage.getItem('language') || 'pt';
    document.getElementById("languageSelector").value = savedLang;
    translatePage(savedLang);
    loadData();
  });
</script>











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































