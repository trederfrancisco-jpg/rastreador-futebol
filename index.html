<script>
  let data = {};

  // Carregar data.json
  async function loadData() {
    try {
      const response = await fetch('/data.json');
      if (!response.ok) throw new Error('Resposta da rede n√£o foi ok');
      data = await response.json();
      filterAndDisplay('all'); // Mostra todos ao iniciar
    } catch (error) {
      console.error('Erro ao carregar data.json:', error);
      document.getElementById("results").innerHTML = `<p>‚ùå Falha ao carregar dados.</p>`;
    }
  }

  // Filtrar e exibir jogos com l√≥gica do G4
  function filterAndDisplay(type) {
    const leagueFilter = document.getElementById("leagueSelect").value;
    const today = new Date('2025-10-02'); // Simulando data atual
    const nextWeek = new Date(today);
    nextWeek.setDate(today.getDate() + 7);

    let matches = [];

    // Incluir todas as ligas do seletor
    const leagues = {
      brasileirao: data.brasileirao || [],
      premierLeague: data.premierLeague || [],
      laliga: data.laliga || [],
      serieA: data.serieA || [],
      bundesliga: data.bundesliga || [],
      ligue1: data.ligue1 || [],
      libertadores: data.libertadores || [],
      champions: data.champions || [],
      europa: data.europa || []
    };

    let selectedLeagues = [];
    if (leagueFilter && leagues[leagueFilter]) {
      selectedLeagues = leagues[leagueFilter];
    } else {
      // Concatenar todas as ligas
      selectedLeagues = [
        ...leagues.brasileirao,
        ...leagues.premierLeague,
        ...leagues.laliga,
        ...leagues.serieA,
        ...leagues.bundesliga,
        ...leagues.ligue1,
        ...leagues.libertadores,
        ...leagues.champions,
        ...leagues.europa
      ];
    }

    selectedLeagues.forEach(day => {
      if (!day || !day.date || !Array.isArray(day.matches)) return;
      const gameDate = new Date(day.date);
      if (gameDate >= today && gameDate <= nextWeek) {
        day.matches.forEach(match => {
          if (!match || !match.home || !match.away) return;
          const isG4Home = isG4Team(match.home);
          const isG4Away = isG4Team(match.away);
          const isG4VsNonG4 = isG4Home && !isG4Away;

          if (isG4VsNonG4) {
            matches.push({
              home: match.home,
              away: match.away,
              date: day.date,
              time: match.time,
              stadium: match.stadium || 'Est√°dio n√£o informado',
              city: match.city || '',
              league: getLeagueName(match),
              strategy: "Time do G4 pressionado joga em casa contra time fora do G4",
              risk: "Baixo",
              badge: "Alta Probabilidade"
            });
          }
        });
      }
    });

    matches.sort((a, b) => new Date(a.date) - new Date(b.date));
    renderMatches(matches);
  }

  function renderMatches(games) {
    const container = document.getElementById("results");
    const date = new Date().toLocaleDateString('pt-BR');

    let html = `<div class="section-title">üî• PR√ìXIMOS EM ALTA (${formatDateRange(new Date('2025-10-02'))})</div>`;

    if (games.length === 0) {
      html += `<p>Nenhum jogo encontrado com a l√≥gica do G4 pressionado.</p>`;
    } else {
      games.forEach(game => {
        const riskClass = game.risk === 'Alto' ? 'red' : game.risk === 'M√©dio' ? 'orange' : 'green';
        const location = game.stadium ? `üèüÔ∏è ${game.stadium}` + (game.city ? ` (${game.city})` : '') : 'üèüÔ∏è Local n√£o informado';
        html += `
          <div class="item">
            <h3>${game.home} vs. ${game.away}</h3>
            <div class="details">
              ‚è∞ ${formatDate(game.date)} √†s ${game.time} | ${location} | üèÜ ${game.league}<br>
              <strong>Estrat√©gia:</strong> ${game.strategy}
            </div>
            <div style="display: flex; gap: 10px; margin-top: 8px;">
              <span class="badge green">${game.badge}</span>
              <span class="risk ${riskClass}">${game.risk} Risco</span>
            </div>
          </div>
        `;
      });
    }

    html += `<div class="tip">üìÖ Dados atualizados em: ${date}</div>`;
    container.innerHTML = html;
  }

  function formatDate(dateStr) {
    return new Date(dateStr).toLocaleDateString('pt-BR');
  }

  function formatDateRange(start) {
    const end = new Date(start);
    end.setDate(start.getDate() + 7);
    return `${formatDate(start)} a ${formatDate(end)}`;
  }

  function getLeagueName(match) {
    const home = match.home;
    if (home.includes("Arsenal") || home.includes("Liverpool") || home.includes("Manchester")) return "Premier League";
    if (home.includes("Barcelona") || home.includes("Real Madrid") || home.includes("Atl√©tico Madrid")) return "LaLiga";
    if (home.includes("Juventus") || home.includes("Milan") || home.includes("Inter") || home.includes("Napoli")) return "Serie A";
    if (home.includes("Bayern") || home.includes("Dortmund") || home.includes("Leipzig")) return "Bundesliga";
    if (home.includes("PSG") || home.includes("Marseille") || home.includes("Lyon")) return "Ligue 1";
    if (home.includes("Flamengo") || home.includes("Palmeiras") || home.includes("Botafogo")) return "Brasileir√£o";
    if (match.league) return match.league;
    return "Outro";
  }

  function isG4Team(team) {
    const g4Teams = [
      "Flamengo", "Palmeiras", "Botafogo", "Gr√™mio", "Atl√©tico-MG", "Internacional",
      "Arsenal", "Liverpool", "Manchester City", "Chelsea",
      "Barcelona", "Real Madrid", "Atl√©tico Madrid", "Villarreal",
      "Juventus", "AC Milan", "Inter", "Napoli",
      "Bayern", "Dortmund", "Leipzig", "Bayer Leverkusen",
      "PSG", "Marseille", "Lyon", "Monaco"
    ];
    return g4Teams.some(g4 => team.includes(g4));
  }

  function setActiveButton(clickedBtn) {
    document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
    clickedBtn.classList.add("active");
  }

  // Corrigido: usar fun√ß√£o normal ou event.target
  document.getElementById("btnChance").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('chance');
  });
  document.getElementById("btnPressureAlert").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('pressure');
  });
  document.getElementById("btnHiddenConflicts").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('hidden');
  });
  document.getElementById("btnReactionChain").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('chain');
  });
  document.getElementById("btnMultiples").addEventListener("click", function() {
    setActiveButton(this);
    filterAndDisplay('multiples');
  });

  document.getElementById("leagueSelect").addEventListener("change", () => filterAndDisplay('all'));

  const translations = {
    pt: { title: "Rastreador Avan√ßado - M√∫ltiplos em Alta", btnPrimary: "üöÄ QUERO ASSINAR O RASTREADOR PRO" },
    en: { title: "Advanced Tracker - High Probability Multiples", btnPrimary: "üöÄ I WANT TO JOIN THE PRO TRACKER" },
    es: { title: "Rastreador Avanzado - M√∫ltiples en Alta", btnPrimary: "üöÄ QUIERO SUSCRIBIRME AL RASTREADOR PRO" }
  };

  function translatePage(lang) {
    document.title = translations[lang]?.title || translations.pt.title;
    const btn = document.querySelector(".btn-primary");
    if (btn) btn.textContent = translations[lang]?.btnPrimary || translations.pt.btnPrimary;
  }

  document.getElementById("languageSelector").addEventListener("change", function() {
    const lang = this.value;
    translatePage(lang);
    localStorage.setItem('language', lang);
  });

  document.addEventListener('DOMContentLoaded', function() {
    const savedLang = localStorage.getItem('language') || 'pt';
    document.getElementById("languageSelector").value = savedLang;
    translatePage(savedLang);
    loadData();
  });
</script>














































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































