<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rastreador Avan√ßado - Jogos do Dia</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #121212; color: white; display: flex; height: 100vh; }
  #sidebar { width: 320px; background: #1e1e1e; padding: 20px; box-sizing: border-box; overflow-y: auto; }
  #content { flex-grow: 1; padding: 20px; box-sizing: border-box; overflow-y: auto; background: #222; }
  h1,h2 { margin-top:0; }
  select { width:100%; padding:10px; margin-bottom:15px; background:#333; border:none; color:white; border-radius:4px; font-size:1rem; cursor:pointer; }
  .info-box { background:#ff9800; color:black; padding:8px; border-radius:4px; font-weight:bold; text-align:center; margin-bottom:15px; }
  #results { margin-top:15px; max-height:70vh; overflow-y:auto; background:#121212; padding:10px; border-radius:6px; }
  .item { padding:12px 10px; border-bottom:1px solid #444; }
  .item:last-child { border-bottom:none; }
  .loading { font-style:italic; color:#aaa; text-align:center; margin:10px 0; }
  .error { color:#ff6b6b; font-weight:bold; text-align:center; }
  .details { font-size:0.9em; color:#ccc; margin-top:6px; line-height:1.5; }
  .tip { font-style:italic; color:#bbb; margin-top:15px; text-align:center; }
  nav { display:flex; margin-bottom:15px; }
  nav button { flex:1; margin-right:5px; padding:10px; background:#333; border:none; color:white; border-radius:4px; cursor:pointer; }
  nav button:last-child { margin-right:0; }
  nav button.active { background:#ff9800; color:black; font-weight:bold; }
</style>
</head>
<body>
  <div id="sidebar">
    <h1>Rastreador Avan√ßado</h1>
    <label for="leagueSelect">Selecione Campeonato:</label>
    <select id="leagueSelect" onchange="loadData()">
      <option value="">Todos os Campeonatos</option>
    </select>
    <div id="sidebarInfo" class="info-box">Carregando...</div>
    <nav>
      <button id="btnAll" class="active" onclick="setTab('all')">üéØ Jogos do Dia</button>
    </nav>
  </div>

  <div id="content">
    <h2>Jogos do Dia</h2>
    <div id="results" class="loading">Carregando jogos...</div>
  </div>

<script>
let teamResults = {};
let currentTab = "all";

function setTab(tab) {
  currentTab = tab;
  document.getElementById("btnAll").classList.toggle("active", tab === "all");
  if (Object.keys(teamResults).length) showAllGames();
}

// Mapeia os eventos da API SofaScore
function mapearJogos(data) {
  const resultados = {};
  data.events.forEach(evento => {
    const home = evento.homeTeam.name;
    const away = evento.awayTeam.name;
    const matchDate = new Date(evento.startTimestamp * 1000);
    const match_date = matchDate.toLocaleDateString('pt-BR');
    const match_time = matchDate.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
    resultados[home] = {
      next_opponent: away,
      match_date,
      match_time,
      home_away: "Casa",
      league: evento.tournament.name
    };
    resultados[away] = {
      next_opponent: home,
      match_date,
      match_time,
      home_away: "Fora",
      league: evento.tournament.name
    };
  });
  return resultados;
}

// Carrega jogos do dia
async function loadData() {
  const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "<p class='loading'>üîÑ Carregando dados...</p>";
  try {
    const response = await fetch(`https://api.sofascore.com/api/v1/sport/football/scheduled-events/${today}`);
    const data = await response.json();
    teamResults = mapearJogos(data);
    showAllGames();
    document.getElementById("sidebarInfo").textContent = `‚úÖ Jogos do dia carregados (${Object.keys(teamResults).length})`;
  } catch(err) {
    console.error(err);
    resultsDiv.innerHTML = "<p class='error'>‚ùå Falha ao carregar jogos do dia.</p>";
  }
}

// Mostra todos os jogos
function showAllGames() {
  const resultsDiv = document.getElementById("results");
  const teams = Object.keys(teamResults);
  if (!teams.length) {
    resultsDiv.innerHTML = "<p>Nenhum jogo encontrado.</p>";
    return;
  }
  let html = "";
  const jaMostrados = new Set();
  teams.forEach(team => {
    const t = teamResults[team];
    const key = `${team} vs ${t.next_opponent}`;
    if (jaMostrados.has(key)) return;
    jaMostrados.add(key);
    html += `
      <div class="item">
        <strong>${team}</strong> vs <strong>${t.next_opponent}</strong> <em>(${t.league})</em><br>
        üèüÔ∏è ${t.home_away} | üìÖ ${t.match_date} | ‚è∞ ${t.match_time}
      </div>
    `;
  });
  resultsDiv.innerHTML = html;
}

loadData();
</script>
</body>
</html>


